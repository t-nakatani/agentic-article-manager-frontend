# Next.js 改善点メモ

## App Router の最適化

### Server Components の活用 (取り組み開始)
- クライアントコンポーネント (`"use client"`) を必要以上に使用している
  - 改善: 表示専用のNavigationLinksコンポーネントをServer Componentに変更
  - 改善: StarIconコンポーネントをServer Componentに変更
  - 改善: AppLogoコンポーネントは既にServer Componentとして実装されており、適切
- Server Componentに適したコンポーネントの特徴:
  - 状態管理 (useState) を使用していない
  - イベントハンドラが不要
  - useEffectなどの副作用フックを使用していない
  - ブラウザAPIに依存していない
  - データ表示が主な役割
- 状態管理やイベントハンドラが不要な表示専用コンポーネントは Server Components に変更すべき
- データフェッチは可能な限り Server Components で行い、パフォーマンスを向上させる

### ルーティング構造の見直し
- 現在のルート構造が複雑になっている可能性
- グループルート (`(group)`) やプライベートフォルダ (`_components`) の活用が不十分
- 適切なレイアウト構造 (`layout.tsx`) の見直しが必要

## データフェッチの最適化

### キャッシュとリバリデーションの活用
- `fetch` のキャッシュオプションを活用していない
- ISR (Incremental Static Regeneration) の `revalidate` オプションの検討
- RSC (React Server Components) での効率的なデータフェッチが不足

### Suspense の適切な使用
- `<Suspense>` によるローディング状態の適切な管理ができていない
- ストリーミングレスポンスの恩恵を受けられていない

## パフォーマンス最適化

### 画像最適化
- `next/image` コンポーネントを十分に活用できていない
- 画像の自動最適化、WebP形式の活用、サイズ指定が不足

### ビルド時の最適化
- 静的生成（SSG）とサーバーサイドレンダリング（SSR）の適切な使い分けが不足
- `generateStaticParams` を使った効率的な静的ページ生成の検討

### Code Splitting の改善
- `next/dynamic` による効率的なコード分割が不足
- 重要でないUIコンポーネントの遅延ロードが適切に行われていない

## 状態管理の改善

### Redux 導入の進行状況
- Redux Toolkit への移行計画はあるが、実装が不完全
- 状態管理が分散している（Context APIとReduxの混在）
- ReduxのSelector最適化が不足している可能性

## TypeScript の活用

### 型安全性の向上
- APIレスポンスの型定義が不十分
- Zod などによるランタイム型チェックの導入検討
- ページコンポーネントの適切な型付けが不足

## セキュリティとバリデーション

### 入力検証の強化
- フォーム入力のバリデーションが不十分
- サーバーサイドでの検証が不足している可能性

### CSP (Content Security Policy) の設定
- Next.js のセキュリティヘッダー設定が不足している可能性
- `next.config.js` での適切なセキュリティ設定の確認

## 開発効率の向上

### Next.js 14の新機能対応
- Server Actionsの活用が不足
- Turbopackへの移行検討

### テスト環境の整備
- Cypress の設定はあるが、テストカバレッジが不明
- コンポーネントテストとE2Eテストの拡充

## アクセシビリティの改善

### ARIA属性の適切な使用
- アクセシビリティ対応が不十分な可能性
- キーボード操作の対応状況を確認

## 国際化対応

### i18n実装の検討
- 多言語対応の準備ができていない
- next-intl などのライブラリ導入の検討

## デプロイと環境設定

### 環境変数の管理
- 環境変数の適切な管理と使用方法の確認
- 本番/開発/テスト環境の設定分離

### CI/CDパイプラインの最適化
- ビルドプロセスの効率化
- デプロイ戦略の見直し
